@model OptionTracker.Models.ViewModels.CreateTradeVM

@{
    ViewData["Title"] = "Details";
    var trade = Model.Trade;
    var options = Model.Options;
    var optionCount = options.Count();
}

<div class="row">
    <div class="col"><h2>Trade Details</h2></div>
    <div class="col">
        <div class="text-right mt-3">
            <a class="btn btn-primary btn-sm" asp-controller="Options" asp-action="Create" asp-route-id="@trade.Tradeid">Add Option</a>
            <a class="btn btn-info btn-sm" asp-action="Edit" asp-route-id="@trade.Tradeid">Edit Trade</a>
        </div>
    </div>
</div>

<hr />

<div>

    <div class="container border rounded">
        <div class="pt-3 pb-3">


            <div class="row headers">
                <div class="col-sm">
                    @Html.DisplayNameFor(model => trade.StockSymbol)
                </div>
                <div class="col-sm">
                    @Html.DisplayNameFor(model => trade.Description)
                </div>
                <div class="col-sm">
                    @Html.DisplayNameFor(model => trade.Notes)
                </div>
                <div class="col-sm">
                    @Html.DisplayNameFor(model => trade.DateEntered)
                </div>
                <div class="col-sm">
                    @Html.DisplayNameFor(model => trade.TradeTypeId)
                </div>
            </div>
            <div class="row">
                <div class="col-sm">
                    <strong>@Html.DisplayFor(model => trade.StockSymbol)</strong>
                </div>
                <div class="col-sm">
                    @Html.DisplayFor(model => trade.Description)
                </div>
                <div class="col-sm">
                    @Html.DisplayFor(model => trade.Notes)
                </div>
                <div class="col-sm">
                    @Html.DisplayFor(model => trade.DateEntered)
                </div>
                <div class="col-sm">
                    @Html.DisplayFor(model => trade.TradeTypes.Description)
                </div>
            </div>

        </div>

    </div>

</div>


 
@if(optionCount > 0)
{
    <div class="bodrer p5 mt-5">
        
        <table class="table table-striped table-bordered table-hover">
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Strike</th>
                <th style="width:150px;">Exp Date</th>
                <th>Option Price</th>
                <th>Qty</th>
                <th style="width:100px;">Commission</th>
                <th>Total Cost</th>
                <th>P/L</th>
                <th style="width:150px;"></th>
            </tr>
        @foreach(var option in options)
        {
        <tr>
            <td>@option.DateEntered.ToString("MM/dd/yyyy")</td>
            <td>@option.OptionType.Description</td>
            <td>@option.StrikePrice</td>
            <td>@option.ExpirationDate.ToString("MM/dd/yyyy")</td>
            <td>@Html.Raw(String.Format("{0:c}", option.EntryPrice))</td>
            <td>@option.Quantity</td>
            <td>@option.Commission</td>
            <td>
                @{ 
                    var totalCost = (option.EntryPrice * 100 * option.Quantity) + option.Commission;
                    <span>@Html.Raw(String.Format("{0:c}", totalCost))</span>
                }
            </td>
            <td></td>
            <td nowrap>
                <a class="btn btn-primary btn-sm" asp-controller="Options" asp-action="Edit" asp-route-id="@option.Optionid">Edit</a>
                <a class="btn btn-info btn-sm" asp-controller="Options" asp-action="Details" asp-route-id="@option.Optionid">Details</a>
                <a class="btn btn-danger btn-sm" asp-controller="Options" asp-action="Delete" asp-route-id="@option.Optionid">Delete</a>
            </td>
        </tr>
  

        }
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>@Html.Raw(String.Format("{0:c}", @Model.TotalTradeCost))</td>
            <td>@Html.Raw(String.Format("{0:c}", @Model.TotalExitPrice))</td>
            <td></td>
        </tr>         
        </table>
    </div>  

}
 
<div class="row">
    <div class="col">
        <div class="text-left mt-3">
            <a class="btn btn-secondary btn-sm" asp-action="Index">Back to Trade List</a>
        </div>
    </div>
</div>
